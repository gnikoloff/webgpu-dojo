!function(){"use strict";function e(e,a,s,l){return new(s=s||Promise)(function(n,t){function i(e){try{r(l.next(e))}catch(e){t(e)}}function o(e){try{r(l.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((l=l.apply(e,a||[])).next())})}function t(e,t){var n=e.__state.conversionName.toString(),i=Math.round(e.r),o=Math.round(e.g),r=Math.round(e.b),a=e.a,s=Math.round(e.h),l=e.s.toFixed(1),u=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var d=e.hex.toString(16);d.length<6;)d="0"+d;return"#"+d}return"CSS_RGB"===n?"rgb("+i+","+o+","+r+")":"CSS_RGBA"===n?"rgba("+i+","+o+","+r+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+i+","+o+","+r+"]":"RGBA_ARRAY"===n?"["+i+","+o+","+r+","+a+"]":"RGB_OBJ"===n?"{r:"+i+",g:"+o+",b:"+r+"}":"RGBA_OBJ"===n?"{r:"+i+",g:"+o+",b:"+r+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+u+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+u+",a:"+a+"}":"unknown format"}var n,a=Array.prototype.forEach,i=Array.prototype.slice,p={BREAK:{},extend:function(n){return this.each(i.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(t[e])||(n[e]=t[e])}.bind(this))},this),n},defaults:function(n){return this.each(i.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(e){this.isUndefined(n[e])&&(n[e]=t[e])}.bind(this))},this),n},compose:function(){var n=i.call(arguments);return function(){for(var e=i.call(arguments),t=n.length-1;0<=t;t--)e=[n[t].apply(this,e)];return e[0]}},each:function(e,t,n){if(e)if(a&&e.forEach&&e.forEach===a)e.forEach(t,n);else if(e.length===e.length+0){for(var i=void 0,i=0,o=e.length;i<o;i++)if(i in e&&t.call(n,e[i],i)===this.BREAK)return}else for(var r in e)if(t.call(n,e[r],r)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(i,o,r){var a=void 0;return function(){var e=this,t=arguments;var n=r||!a;clearTimeout(a),a=setTimeout(function(){a=null,r||i.apply(e,t)},o),n&&i.apply(e,t)}},toArray:function(e){return e.toArray?e.toArray():i.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:(n=function(e){return isNaN(e)},o.toString=function(){return n.toString()},o),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}};function o(e){return n.apply(this,arguments)}var r,s=[{litmus:p.isString,conversions:{THREE_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:t},SIX_CHAR_HEX:{read:function(e){e=e.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:t},CSS_RGB:{read:function(e){e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(e){e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:p.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:p.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:p.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(p.isNumber(e.r)&&p.isNumber(e.g)&&p.isNumber(e.b)&&p.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(p.isNumber(e.r)&&p.isNumber(e.g)&&p.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(p.isNumber(e.h)&&p.isNumber(e.s)&&p.isNumber(e.v)&&p.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(p.isNumber(e.h)&&p.isNumber(e.s)&&p.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],l=void 0,u=void 0,h=function(){u=!1;var n=1<arguments.length?p.toArray(arguments):arguments[0];return p.each(s,function(e){if(e.litmus(n))return p.each(e.conversions,function(e,t){if(l=e.read(n),!1===u&&!1!==l)return(u=l).conversionName=t,l.conversion=e,p.BREAK}),p.BREAK}),u},d={hsv_to_rgb:function(e,t,n){var i=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),r=n*(1-t),e=n*(1-o*t),t=n*(1-(1-o)*t),i=[[n,t,r],[e,n,r],[r,n,t],[r,e,n],[t,r,n],[n,r,e]][i];return{r:255*i[0],g:255*i[1],b:255*i[2]}},rgb_to_hsv:function(e,t,n){var i=Math.min(e,t,n),o=Math.max(e,t,n),r=o-i,i=void 0;return 0===o?{h:NaN,s:0,v:0}:(i=e===o?(t-n)/r:t===o?2+(n-e)/r:4+(e-t)/r,(i/=6)<0&&(i+=1),{h:360*i,s:r/o,v:o/255})},rgb_to_hex:function(e,t,n){e=this.hex_with_component(0,2,e),e=this.hex_with_component(e,1,t);return e=this.hex_with_component(e,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(r=8*t)|e&~(255<<r)}},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_=function(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e};function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function g(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0!==i){if("value"in i)return i.value;i=i.get;return void 0!==i?i.call(n):void 0}if(null!==(e=Object.getPrototypeOf(e)))return g(e,t,n)}var v=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},b=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},y=(_(w,[{key:"toString",value:function(){return t(this)}},{key:"toHexString",value:function(){return t(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),w);function w(){if(f(this,w),this.__state=h.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}function x(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||y.recalculateRGB(this,t,n),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(y.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function E(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||y.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(y.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}y.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=d.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");p.extend(e.__state,d.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},y.recalculateHSV=function(e){var t=d.rgb_to_hsv(e.r,e.g,e.b);p.extend(e.__state,{s:t.s,v:t.v}),p.isNaN(t.h)?p.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},y.COMPONENTS=["r","g","b","h","s","v","hex","a"],x(y.prototype,"r",2),x(y.prototype,"g",1),x(y.prototype,"b",0),E(y.prototype,"h"),E(y.prototype,"s"),E(y.prototype,"v"),Object.defineProperty(y.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(y.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=d.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var A=(_(S,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),S);function S(e,t){f(this,S),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}var M={};p.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,t){p.each(e,function(e){M[e]=t})});var C=/(\d+(\.\d+)?)px/;function T(e){if("0"===e||p.isUndefined(e))return 0;e=e.match(C);return p.isNull(e)?0:parseFloat(e[1])}var B={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){p.isUndefined(t)&&(t=!0),p.isUndefined(n)&&(n=!0),e.style.position="absolute",t&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,i){var o=n||{},n=M[t];if(!n)throw new Error("Event type "+t+" not supported.");var r=document.createEvent(n);switch(n){case"MouseEvents":var a=o.x||o.clientX||0,s=o.y||o.clientY||0;r.initMouseEvent(t,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,a,s,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":s=r.initKeyboardEvent||r.initKeyEvent;p.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),s(t,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break;default:r.initEvent(t,o.bubbles||!1,o.cancelable||!0)}p.defaults(r,i),e.dispatchEvent(r)},bind:function(e,t,n,i){return e.addEventListener?e.addEventListener(t,n,i||!1):e.attachEvent&&e.attachEvent("on"+t,n),B},unbind:function(e,t,n,i){return e.removeEventListener?e.removeEventListener(t,n,i||!1):e.detachEvent&&e.detachEvent("on"+t,n),B},addClass:function(e,t){var n;return void 0===e.className?e.className=t:e.className===t||-1===(n=e.className.split(/ +/)).indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")),B},removeClass:function(e,t){var n;return t?e.className===t?e.removeAttribute("class"):-1!==(t=(n=e.className.split(/ +/)).indexOf(t))&&(n.splice(t,1),e.className=n.join(" ")):e.className=void 0,B},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){e=getComputedStyle(e);return T(e["border-left-width"])+T(e["border-right-width"])+T(e["padding-left"])+T(e["padding-right"])+T(e.width)},getHeight:function(e){e=getComputedStyle(e);return T(e["border-top-width"])+T(e["border-bottom-width"])+T(e["padding-top"])+T(e["padding-bottom"])+T(e.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)for(;n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent;);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},P=(v(F,A),_(F,[{key:"setValue",value:function(e){e=g(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),g(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"updateDisplay",this).call(this)}}]),F);function F(e,t){f(this,F);var t=b(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,e,t)),n=t;return t.__prev=t.getValue(),t.__checkbox=document.createElement("input"),t.__checkbox.setAttribute("type","checkbox"),B.bind(t.__checkbox,"change",function(){n.setValue(!n.__prev)},!1),t.domElement.appendChild(t.__checkbox),t.updateDisplay(),t}var k=(v(O,A),_(O,[{key:"setValue",value:function(e){e=g(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e}},{key:"updateDisplay",value:function(){return B.isActive(this.__select)?this:(this.__select.value=this.getValue(),g(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"updateDisplay",this).call(this))}}]),O);function O(e,t,n){f(this,O);var i,t=b(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,e,t)),n=n,o=t;return t.__select=document.createElement("select"),p.isArray(n)&&(i={},p.each(n,function(e){i[e]=e}),n=i),p.each(n,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),o.__select.appendChild(n)}),t.updateDisplay(),B.bind(t.__select,"change",function(){var e=this.options[this.selectedIndex].value;o.setValue(e)}),t.domElement.appendChild(t.__select),t}var R=(v(U,A),_(U,[{key:"updateDisplay",value:function(){return B.isActive(this.__input)||(this.__input.value=this.getValue()),g(U.prototype.__proto__||Object.getPrototypeOf(U.prototype),"updateDisplay",this).call(this)}}]),U);function U(e,t){f(this,U);var t=b(this,(U.__proto__||Object.getPrototypeOf(U)).call(this,e,t)),n=t;function i(){n.setValue(n.__input.value)}return t.__input=document.createElement("input"),t.__input.setAttribute("type","text"),B.bind(t.__input,"keyup",i),B.bind(t.__input,"change",i),B.bind(t.__input,"blur",function(){n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())}),B.bind(t.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),t.updateDisplay(),t.domElement.appendChild(t.__input),t}function L(e){e=e.toString();return-1<e.indexOf(".")?e.length-e.indexOf(".")-1:0}var N=(v(G,A),_(G,[{key:"setValue",value:function(e){return void 0!==this.__min&&e<this.__min?e=this.__min:void 0!==this.__max&&e>this.__max&&(e=this.__max),void 0!==this.__step&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),g(G.prototype.__proto__||Object.getPrototypeOf(G.prototype),"setValue",this).call(this,e)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=L(e),this}}]),G);function G(e,t,n){f(this,G);t=b(this,(G.__proto__||Object.getPrototypeOf(G)).call(this,e,t)),n=n||{};return t.__min=n.min,t.__max=n.max,t.__step=n.step,p.isUndefined(t.__step)?0===t.initialValue?t.__impliedStep=1:t.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(t.initialValue))/Math.LN10))/10:t.__impliedStep=t.__step,t.__precision=L(t.__impliedStep),t}var V=(v(I,N),_(I,[{key:"updateDisplay",value:function(){var e,t;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),t=this.__precision,t=Math.pow(10,t),Math.round(e*t)/t),g(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"updateDisplay",this).call(this)}}]),I);function I(e,t,n){f(this,I);n=b(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,e,t,n));n.__truncationSuspended=!1;var i=n,o=void 0;function r(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}function a(e){var t=o-e.clientY;i.setValue(i.getValue()+t*i.__impliedStep),o=e.clientY}function s(){B.unbind(window,"mousemove",a),B.unbind(window,"mouseup",s),r()}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),B.bind(n.__input,"change",function(){var e=parseFloat(i.__input.value);p.isNaN(e)||i.setValue(e)}),B.bind(n.__input,"blur",function(){r()}),B.bind(n.__input,"mousedown",function(e){B.bind(window,"mousemove",a),B.bind(window,"mouseup",s),o=e.clientY}),B.bind(n.__input,"keydown",function(e){13===e.keyCode&&(i.__truncationSuspended=!0,this.blur(),i.__truncationSuspended=!1,r())}),n.updateDisplay(),n.domElement.appendChild(n.__input),n}function D(e,t,n,i,o){return i+(e-t)/(n-t)*(o-i)}var z=(v(H,N),_(H,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",g(H.prototype.__proto__||Object.getPrototypeOf(H.prototype),"updateDisplay",this).call(this)}}]),H);function H(e,t,n,i,o){f(this,H);var o=b(this,(H.__proto__||Object.getPrototypeOf(H)).call(this,e,t,{min:n,max:i,step:o})),r=o;function a(e){e.preventDefault();var t=r.__background.getBoundingClientRect();return r.setValue(D(e.clientX,t.left,t.right,r.__min,r.__max)),!1}function s(){B.unbind(window,"mousemove",a),B.unbind(window,"mouseup",s),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function l(e){var t=e.touches[0].clientX,e=r.__background.getBoundingClientRect();r.setValue(D(t,e.left,e.right,r.__min,r.__max))}function u(){B.unbind(window,"touchmove",l),B.unbind(window,"touchend",u),r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}return o.__background=document.createElement("div"),o.__foreground=document.createElement("div"),B.bind(o.__background,"mousedown",function(e){document.activeElement.blur(),B.bind(window,"mousemove",a),B.bind(window,"mouseup",s),a(e)}),B.bind(o.__background,"touchstart",function(e){1===e.touches.length&&(B.bind(window,"touchmove",l),B.bind(window,"touchend",u),l(e))}),B.addClass(o.__background,"slider"),B.addClass(o.__foreground,"slider-fg"),o.updateDisplay(),o.__background.appendChild(o.__foreground),o.domElement.appendChild(o.__background),o}var j=(v(Y,A),_(Y,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),Y);function Y(e,t,n){f(this,Y);var t=b(this,(Y.__proto__||Object.getPrototypeOf(Y)).call(this,e,t)),i=t;return t.__button=document.createElement("div"),t.__button.innerHTML=void 0===n?"Fire":n,B.bind(t.__button,"click",function(e){return e.preventDefault(),i.fire(),!1}),B.addClass(t.__button,"button"),t.domElement.appendChild(t.__button),t}var X=(v(q,A),_(q,[{key:"updateDisplay",value:function(){var t,n=h(this.getValue());!1!==n&&(t=!1,p.each(y.COMPONENTS,function(e){if(!p.isUndefined(n[e])&&!p.isUndefined(this.__color.__state[e])&&n[e]!==this.__color.__state[e])return t=!0,{}},this),t&&p.extend(this.__color.__state,n)),p.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var e=this.__color.v<.5||.5<this.__color.s?255:0,i=255-e;p.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+e+","+e+","+e+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,K(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),p.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+e+","+e+","+e+")",textShadow:this.__input_textShadow+"rgba("+i+","+i+","+i+",.7)"})}}]),q);function q(e,t){f(this,q);var n=b(this,(q.__proto__||Object.getPrototypeOf(q)).call(this,e,t));n.__color=new y(n.getValue()),n.__temp=new y(0);var i=n;n.domElement=document.createElement("div"),B.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",B.bind(n.__input,"keydown",function(e){13===e.keyCode&&l.call(this)}),B.bind(n.__input,"blur",l),B.bind(n.__selector,"mousedown",function(){B.addClass(this,"drag").bind(window,"mouseup",function(){B.removeClass(i.__selector,"drag")})}),B.bind(n.__selector,"touchstart",function(){B.addClass(this,"drag").bind(window,"touchend",function(){B.removeClass(i.__selector,"drag")})});e=document.createElement("div");function o(e){d(e),B.bind(window,"mousemove",d),B.bind(window,"touchmove",d),B.bind(window,"mouseup",a),B.bind(window,"touchend",a)}function r(e){c(e),B.bind(window,"mousemove",c),B.bind(window,"touchmove",c),B.bind(window,"mouseup",s),B.bind(window,"touchend",s)}function a(){B.unbind(window,"mousemove",d),B.unbind(window,"touchmove",d),B.unbind(window,"mouseup",a),B.unbind(window,"touchend",a),u()}function s(){B.unbind(window,"mousemove",c),B.unbind(window,"touchmove",c),B.unbind(window,"mouseup",s),B.unbind(window,"touchend",s),u()}function l(){var e=h(this.value);!1!==e?(i.__color.__state=e,i.setValue(i.__color.toOriginal())):this.value=i.__color.toString()}function u(){i.__onFinishChange&&i.__onFinishChange.call(i,i.__color.toOriginal())}function d(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=i.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,e=n.clientX,n=n.clientY,e=(e-t.left)/(t.right-t.left),t=1-(n-t.top)/(t.bottom-t.top);return 1<t?t=1:t<0&&(t=0),1<e?e=1:e<0&&(e=0),i.__color.v=t,i.__color.s=e,i.setValue(i.__color.toOriginal()),!1}function c(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=i.__hue_field.getBoundingClientRect(),t=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return 1<t?t=1:t<0&&(t=0),i.__color.h=360*t,i.setValue(i.__color.toOriginal()),!1}return p.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),p.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),p.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),p.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),p.extend(e.style,{width:"100%",height:"100%",background:"none"}),K(e,"top","rgba(0,0,0,0)","#000"),p.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(t=n.__hue_field).style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",p.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),B.bind(n.__saturation_field,"mousedown",o),B.bind(n.__saturation_field,"touchstart",o),B.bind(n.__field_knob,"mousedown",o),B.bind(n.__field_knob,"touchstart",o),B.bind(n.__hue_field,"mousedown",r),B.bind(n.__hue_field,"touchstart",r),n.__saturation_field.appendChild(e),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}var W=["-moz-","-o-","-webkit-","-ms-",""];function K(t,n,i,o){t.style.background="",p.each(W,function(e){t.style.cssText+="background: "+e+"linear-gradient("+n+", "+i+" 0%, "+o+" 100%); "})}var N=function(e,t){var n=t||document,t=document.createElement("style");t.type="text/css",t.innerHTML=e;n=n.getElementsByTagName("head")[0];try{n.appendChild(t)}catch(e){}},J=function(e,t){var n=e[t];return p.isArray(arguments[2])||p.isObject(arguments[2])?new k(e,t,arguments[2]):p.isNumber(n)?p.isNumber(arguments[2])&&p.isNumber(arguments[3])?p.isNumber(arguments[4])?new z(e,t,arguments[2],arguments[3],arguments[4]):new z(e,t,arguments[2],arguments[3]):p.isNumber(arguments[4])?new V(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new V(e,t,{min:arguments[2],max:arguments[3]}):p.isString(n)?new R(e,t):p.isFunction(n)?new j(e,t,""):p.isBoolean(n)?new P(e,t):null};var Q=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},Z=(_($,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),p.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",B.unbind(t.domElement,"webkitTransitionEnd",e),B.unbind(t.domElement,"transitionend",e),B.unbind(t.domElement,"oTransitionEnd",e)}var t=this;B.bind(this.domElement,"webkitTransitionEnd",e),B.bind(this.domElement,"transitionend",e),B.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-B.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-B.getHeight(this.domElement)/2+"px"}}]),$);function $(){f(this,$),this.backgroundElement=document.createElement("div"),p.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),B.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),p.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;B.bind(this.backgroundElement,"click",function(){e.hide()})}N(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var ee="Default",te=function(){try{return!!window.localStorage}catch(e){return!1}}(),ne=void 0,ie=!0,oe=void 0,re=!1,ae=[],se=function t(e){var n=this,i=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),B.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=p.defaults(i,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),i=p.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),p.isUndefined(i.load)?i.load={preset:ee}:i.preset&&(i.load.preset=i.preset),p.isUndefined(i.parent)&&i.hideable&&ae.push(this),i.resizable=p.isUndefined(i.parent)&&i.resizable,i.autoPlace&&p.isUndefined(i.scrollable)&&(i.scrollable=!0);var o,r,a,s,l=te&&"true"===localStorage.getItem(fe(0,"isLocal")),u=void 0,d=void 0;function c(e){return e.preventDefault(),r.width+=a-e.clientX,r.onResize(),a=e.clientX,!1}function h(){B.removeClass(r.__closeButton,se.CLASS_DRAG),B.unbind(window,"mousemove",c),B.unbind(window,"mouseup",h)}function f(e){return e.preventDefault(),a=e.clientX,B.addClass(r.__closeButton,se.CLASS_DRAG),B.bind(window,"mousemove",c),B.bind(window,"mouseup",h),!1}Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return(n.parent?n.getRoot():i.load).preset},set:function(e){n.parent?n.getRoot().preset=e:i.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),n.revert()}},width:{get:function(){return i.width},set:function(e){i.width=e,me(n,e)}},name:{get:function(){return i.name},set:function(e){i.name=e,d&&(d.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(e){i.closed=e,i.closed?B.addClass(n.__ul,t.CLASS_CLOSED):B.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return l},set:function(e){te&&((l=e)?B.bind(window,"unload",u):B.unbind(window,"unload",u),localStorage.setItem(fe(0,"isLocal"),e))}}}),p.isUndefined(i.parent)?(this.closed=i.closed||!1,B.addClass(this.domElement,t.CLASS_MAIN),B.makeSelectable(this.domElement,!1),te&&l&&(n.useLocalStorage=!0,(o=localStorage.getItem(fe(0,"gui")))&&(i.load=JSON.parse(o))),this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,B.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),i.closeOnTop?(B.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(B.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),B.bind(this.__closeButton,"click",function(){n.closed=!n.closed})):(void 0===i.closed&&(i.closed=!0),o=document.createTextNode(i.name),B.addClass(o,"controller-name"),d=le(n,o),B.addClass(this.__ul,t.CLASS_CLOSED),B.addClass(d,"title"),B.bind(d,"click",function(e){return e.preventDefault(),n.closed=!n.closed,!1}),i.closed||(this.closed=!1)),i.autoPlace&&(p.isUndefined(i.parent)&&(ie&&(oe=document.createElement("div"),B.addClass(oe,"dg"),B.addClass(oe,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(oe),ie=!1),oe.appendChild(this.domElement),B.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||me(n,i.width)),this.__resizeHandler=function(){n.onResizeDebounced()},B.bind(window,"resize",this.__resizeHandler),B.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),B.bind(this.__ul,"transitionend",this.__resizeHandler),B.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&(a=void 0,(r=this).__resize_handle=document.createElement("div"),p.extend(r.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),B.bind(r.__resize_handle,"mousedown",f),B.bind(r.__closeButton,"mousedown",f),r.domElement.insertBefore(r.__resize_handle,r.domElement.firstElementChild)),u=function(){te&&"true"===localStorage.getItem(fe(0,"isLocal"))&&localStorage.setItem(fe(0,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=u,i.parent||((s=n.getRoot()).width+=1,p.defer(function(){--s.width}))};function le(e,t,n){var i=document.createElement("li");return t&&i.appendChild(t),n?e.__ul.insertBefore(i,n):e.__ul.appendChild(i),e.onResize(),i}function ue(e){B.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&B.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function de(e,t){e=e.__preset_select[e.__preset_select.selectedIndex];e.innerHTML=t?e.value+"*":e.value}function ce(e,t){var n=e.getRoot(),i=n.__rememberedObjects.indexOf(t.object);if(-1!==i){var o=n.__rememberedObjectIndecesToControllers[i];if(void 0===o&&(n.__rememberedObjectIndecesToControllers[i]=o={}),o[t.property]=t,n.load&&n.load.remembered){o=n.load.remembered,n=void 0;if(o[e.preset])n=o[e.preset];else{if(!o[ee])return;n=o[ee]}n[i]&&void 0!==n[i][t.property]&&(i=n[i][t.property],t.initialValue=i,t.setValue(i))}}}function he(e,t,n,i){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var o=void 0;o=i.color?new X(t,n):(r=[t,n].concat(i.factoryArgs),J.apply(e,r)),i.before instanceof A&&(i.before=i.before.__li),ce(e,o),B.addClass(o.domElement,"c");n=document.createElement("span");B.addClass(n,"property-name"),n.innerHTML=o.property;var r=document.createElement("div");r.appendChild(n),r.appendChild(o.domElement);var a,s,l,u,i=le(e,r,i.before);return B.addClass(i,se.CLASS_CONTROLLER_ROW),o instanceof X?B.addClass(i,"color"):B.addClass(i,c(o.getValue())),a=e,s=i,(l=o).__li=s,l.__gui=a,p.extend(l,{options:function(e){if(1<arguments.length){var t=l.__li.nextElementSibling;return l.remove(),he(a,l.object,l.property,{before:t,factoryArgs:[p.toArray(arguments)]})}if(p.isArray(e)||p.isObject(e)){t=l.__li.nextElementSibling;return l.remove(),he(a,l.object,l.property,{before:t,factoryArgs:[e]})}},name:function(e){return l.__li.firstElementChild.firstElementChild.innerHTML=e,l},listen:function(){return l.__gui.listen(l),l},remove:function(){return l.__gui.remove(l),l}}),l instanceof z?(u=new V(l.object,l.property,{min:l.__min,max:l.__max,step:l.__step}),p.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(e){var t=l[e],n=u[e];l[e]=u[e]=function(){var e=Array.prototype.slice.call(arguments);return n.apply(u,e),t.apply(l,e)}}),B.addClass(s,"has-slider"),l.domElement.insertBefore(u.domElement,l.domElement.firstElementChild)):l instanceof V?(i=function(e){if(p.isNumber(l.__min)&&p.isNumber(l.__max)){var t=l.__li.firstElementChild.firstElementChild.innerHTML,n=-1<l.__gui.__listening.indexOf(l);l.remove();var i=he(a,l.object,l.property,{before:l.__li.nextElementSibling,factoryArgs:[l.__min,l.__max,l.__step]});return i.name(t),n&&i.listen(),i}return e},l.min=p.compose(i,l.min),l.max=p.compose(i,l.max)):l instanceof P?(B.bind(s,"click",function(){B.fakeEvent(l.__checkbox,"click")}),B.bind(l.__checkbox,"click",function(e){e.stopPropagation()})):l instanceof j?(B.bind(s,"click",function(){B.fakeEvent(l.__button,"click")}),B.bind(s,"mouseover",function(){B.addClass(l.__button,"hover")}),B.bind(s,"mouseout",function(){B.removeClass(l.__button,"hover")})):l instanceof X&&(B.addClass(s,"color"),l.updateDisplay=p.compose(function(e){return s.style.borderLeftColor=l.__color.toString(),e},l.updateDisplay),l.updateDisplay()),l.setValue=p.compose(function(e){return a.getRoot().__preset_select&&l.isModified()&&de(a.getRoot(),!0),e},l.setValue),e.__controllers.push(o),o}function fe(e,t){return document.location.href+"."+t}function pe(e,t,n){var i=document.createElement("option");i.innerHTML=t,i.value=t,e.__preset_select.appendChild(i),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function _e(e,t){t.style.display=e.useLocalStorage?"block":"none"}function me(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function ge(o,r){var a={};return p.each(o.__rememberedObjects,function(e,t){var n={},i=o.__rememberedObjectIndecesToControllers[t];p.each(i,function(e,t){n[t]=r?e.initialValue:e.getValue()}),a[t]=n}),a}se.toggleHide=function(){re=!re,p.each(ae,function(e){e.domElement.style.display=re?"none":""})},se.CLASS_AUTO_PLACE="a",se.CLASS_AUTO_PLACE_CONTAINER="ac",se.CLASS_MAIN="main",se.CLASS_CONTROLLER_ROW="cr",se.CLASS_TOO_TALL="taller-than-window",se.CLASS_CLOSED="closed",se.CLASS_CLOSE_BUTTON="close-button",se.CLASS_CLOSE_TOP="close-top",se.CLASS_CLOSE_BOTTOM="close-bottom",se.CLASS_DRAG="drag",se.DEFAULT_WIDTH=245,se.TEXT_CLOSED="Close Controls",se.TEXT_OPEN="Open Controls",se._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||se.toggleHide()},B.bind(window,"keydown",se._keydownHandler,!1),p.extend(se.prototype,{add:function(e,t){return he(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return he(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;p.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&oe.removeChild(this.domElement);var t=this;p.each(this.__folders,function(e){t.removeFolder(e)}),B.unbind(window,"keydown",se._keydownHandler,!1),ue(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);t=new se(t);this.__folders[e]=t;e=le(this,t.domElement);return B.addClass(e,"folder"),t},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],ue(t);var e=this;p.each(t.__folders,function(e){t.removeFolder(e)}),p.defer(function(){e.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e,t,n=this.getRoot();n.scrollable&&(e=B.getOffset(n.__ul).top,t=0,p.each(n.__ul.childNodes,function(e){n.autoPlace&&e===n.__save_row||(t+=B.getHeight(e))}),window.innerHeight-e-20<t?(B.addClass(n.domElement,se.CLASS_TOO_TALL),n.__ul.style.height=window.innerHeight-e-20+"px"):(B.removeClass(n.domElement,se.CLASS_TOO_TALL),n.__ul.style.height="auto")),n.__resize_handle&&p.defer(function(){n.__resize_handle.style.height=n.__ul.offsetHeight+"px"}),n.__closeButton&&(n.__closeButton.style.width=n.width+"px")},onResizeDebounced:p.debounce(function(){this.onResize()},50),remember:function(){if(p.isUndefined(ne)&&((ne=new Z).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;p.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&function(n){var e=n.__save_row=document.createElement("li");B.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),B.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",B.addClass(t,"button gears");var i=document.createElement("span");i.innerHTML="Save",B.addClass(i,"button"),B.addClass(i,"save");var o=document.createElement("span");o.innerHTML="New",B.addClass(o,"button"),B.addClass(o,"save-as");var r=document.createElement("span");r.innerHTML="Revert",B.addClass(r,"button"),B.addClass(r,"revert");var a=n.__preset_select=document.createElement("select");n.load&&n.load.remembered?p.each(n.load.remembered,function(e,t){pe(n,t,t===n.preset)}):pe(n,ee,!1);{var s;B.bind(a,"change",function(){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].innerHTML=n.__preset_select[e].value;n.preset=this.value}),e.appendChild(a),e.appendChild(t),e.appendChild(i),e.appendChild(o),e.appendChild(r),te&&(s=document.getElementById("dg-local-explain"),e=document.getElementById("dg-local-storage"),document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(fe(0,"isLocal"))&&e.setAttribute("checked","checked"),_e(n,s),B.bind(e,"change",function(){n.useLocalStorage=!n.useLocalStorage,_e(n,s)}))}var l=document.getElementById("dg-new-constructor");B.bind(l,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||ne.hide()}),B.bind(t,"click",function(){l.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),ne.show(),l.focus(),l.select()}),B.bind(i,"click",function(){n.save()}),B.bind(o,"click",function(){var e=prompt("Enter a new preset name.");e&&n.saveAs(e)}),B.bind(r,"click",function(){n.revert()})}(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&me(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var n=this.load;return n.closed=this.closed,0<this.__rememberedObjects.length&&(n.preset=this.preset,n.remembered||(n.remembered={}),n.remembered[this.preset]=ge(this)),n.folders={},p.each(this.__folders,function(e,t){n.folders[t]=e.getSaveObject()}),n},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=ge(this),de(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[ee]=ge(this,!0)),this.load.remembered[e]=ge(this),this.preset=e,pe(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(t){p.each(this.__controllers,function(e){this.getRoot().load.remembered?ce(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),p.each(this.__folders,function(e){e.revert(e)}),t||de(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&Q.call(window,function(){e(t)});p.each(t,function(e){e.updateDisplay()})}(this.__listening)},updateDisplay:function(){p.each(this.__controllers,function(e){e.updateDisplay()}),p.each(this.__folders,function(e){e.updateDisplay()})}});v=se;var ve="undefined"!=typeof Float32Array?Float32Array:Array;function be(){var e=new ve(16);return ve!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ye(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function we(e,t,n,i){var o,r=t[0],a=t[1],s=t[2],l=i[0],u=i[1],d=i[2],c=n[0],h=n[1],f=n[2];return Math.abs(r-c)<1e-6&&Math.abs(a-h)<1e-6&&Math.abs(s-f)<1e-6?ye(e):(o=r-c,t=a-h,i=s-f,c=u*(i*=n=1/Math.hypot(o,t,i))-d*(t*=n),h=d*(o*=n)-l*i,f=l*t-u*o,(n=Math.hypot(c,h,f))?(c*=n=1/n,h*=n,f*=n):f=h=c=0,d=t*f-i*h,l=i*c-o*f,u=o*h-t*c,(n=Math.hypot(d,l,u))?(d*=n=1/n,l*=n,u*=n):u=l=d=0,e[0]=c,e[1]=d,e[2]=o,e[3]=0,e[4]=h,e[5]=l,e[6]=t,e[7]=0,e[8]=f,e[9]=u,e[10]=i,e[11]=0,e[12]=-(c*r+h*a+f*s),e[13]=-(d*r+l*a+u*s),e[14]=-(o*r+t*a+i*s),e[15]=1,e)}function xe(){var e=new ve(3);return ve!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ee(e,t,n){var i=new ve(3);return i[0]=e,i[1]=t,i[2]=n,i}function Ae(e,t,n,i){return e[0]=t,e[1]=n,e[2]=i,e}function Se(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Me(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function Ce(e,t){var n=t[0],i=t[1],o=t[2],o=n*n+i*i+o*o;return 0<o&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Te=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e};function Be(){var e=new ve(2);return ve!=Float32Array&&(e[0]=0,e[1]=0),e}xe(),Be();class Pe{constructor(){this.position=Ee(0,0,0),this.rotation=Ee(0,0,0),this.scale=Ee(1,1,1),this.modelMatrix=be(),this.shouldUpdate=!0}copyFromMatrix(e){var t;return t=this.modelMatrix,e=e,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this.shouldUpdate=!1,this}setPosition(e){var{x:t=this.position[0],y:n=this.position[1],z:e=this.position[2]}=e;return Ae(this.position,t,n,e),this.shouldUpdate=!0,this}setScale(e){var{x:t=this.scale[0],y:n=this.scale[1],z:e=this.scale[2]}=e;return Ae(this.scale,t,n,e),this.shouldUpdate=!0,this}setRotation(e){var{x:t=this.rotation[0],y:n=this.rotation[1],z:e=this.rotation[2]}=e;return Ae(this.rotation,t,n,e),this.shouldUpdate=!0,this}updateModelMatrix(){var e,t,n,i,o,r,a,s,l,u,d,c,h,f,p,_,m;return ye(this.modelMatrix),f=this.modelMatrix,r=this.modelMatrix,h=this.position,c=h[0],p=h[1],u=h[2],r===f?(f[12]=r[0]*c+r[4]*p+r[8]*u+r[12],f[13]=r[1]*c+r[5]*p+r[9]*u+r[13],f[14]=r[2]*c+r[6]*p+r[10]*u+r[14],f[15]=r[3]*c+r[7]*p+r[11]*u+r[15]):(e=r[0],t=r[1],l=r[2],d=r[3],n=r[4],i=r[5],_=r[6],m=r[7],o=r[8],a=r[9],s=r[10],h=r[11],f[0]=e,f[1]=t,f[2]=l,f[3]=d,f[4]=n,f[5]=i,f[6]=_,f[7]=m,f[8]=o,f[9]=a,f[10]=s,f[11]=h,f[12]=e*c+n*p+o*u+r[12],f[13]=t*c+i*p+a*u+r[13],f[14]=l*c+_*p+s*u+r[14],f[15]=d*c+m*p+h*u+r[15]),a=this.modelMatrix,l=this.modelMatrix,_=this.rotation[0],s=Math.sin(_),f=Math.cos(_),d=l[4],c=l[5],m=l[6],p=l[7],h=l[8],u=l[9],r=l[10],_=l[11],l!==a&&(a[0]=l[0],a[1]=l[1],a[2]=l[2],a[3]=l[3],a[12]=l[12],a[13]=l[13],a[14]=l[14],a[15]=l[15]),a[4]=d*f+h*s,a[5]=c*f+u*s,a[6]=m*f+r*s,a[7]=p*f+_*s,a[8]=h*f-d*s,a[9]=u*f-c*s,a[10]=r*f-m*s,a[11]=_*f-p*s,l=this.modelMatrix,h=this.modelMatrix,d=this.rotation[1],u=Math.sin(d),c=Math.cos(d),r=h[0],m=h[1],a=h[2],_=h[3],f=h[8],p=h[9],s=h[10],d=h[11],h!==l&&(l[4]=h[4],l[5]=h[5],l[6]=h[6],l[7]=h[7],l[12]=h[12],l[13]=h[13],l[14]=h[14],l[15]=h[15]),l[0]=r*c-f*u,l[1]=m*c-p*u,l[2]=a*c-s*u,l[3]=_*c-d*u,l[8]=r*u+f*c,l[9]=m*u+p*c,l[10]=a*u+s*c,l[11]=_*u+d*c,h=this.modelMatrix,r=this.modelMatrix,f=this.rotation[2],m=Math.sin(f),p=Math.cos(f),a=r[0],s=r[1],l=r[2],_=r[3],u=r[4],d=r[5],c=r[6],f=r[7],r!==h&&(h[8]=r[8],h[9]=r[9],h[10]=r[10],h[11]=r[11],h[12]=r[12],h[13]=r[13],h[14]=r[14],h[15]=r[15]),h[0]=a*p+u*m,h[1]=s*p+d*m,h[2]=l*p+c*m,h[3]=_*p+f*m,h[4]=u*p-a*m,h[5]=d*p-s*m,h[6]=c*p-l*m,h[7]=f*p-_*m,h=this.modelMatrix,f=this.modelMatrix,p=this.scale,_=p[0],m=p[1],p=p[2],h[0]=f[0]*_,h[1]=f[1]*_,h[2]=f[2]*_,h[3]=f[3]*_,h[4]=f[4]*m,h[5]=f[5]*m,h[6]=f[6]*m,h[7]=f[7]*m,h[8]=f[8]*p,h[9]=f[9]*p,h[10]=f[10]*p,h[11]=f[11]*p,h[12]=f[12],h[13]=f[13],h[14]=f[14],h[15]=f[15],this.shouldUpdate=!1,this}}const Fe=(e,t,n)=>(n-e)/(t-e),ke=e=>(e-=2*Math.floor(.5*e),e=Math.min(Math.max(e,0),2),1-Math.abs(e-1));class Oe{constructor(e,t,n,i){this.position=[0,0,0],this.lookAtPosition=[0,0,0],this.projectionMatrix=be(),this.viewMatrix=be(),this.zoom=1,this.fieldOfView=e,this.aspect=t,this.near=n,this.far=i,this.updateProjectionMatrix()}setPosition({x:e=this.position[0],y:t=this.position[1],z:n=this.position[2]}){return this.position=[e,t,n],this}updateViewMatrix(){return we(this.viewMatrix,this.position,this.lookAtPosition,Oe.UP_VECTOR),this}updateProjectionMatrix(){var e,t,n,i,o;return e=this.projectionMatrix,t=this.fieldOfView,n=this.aspect,i=this.near,o=this.far,t=1/Math.tan(t/2),e[0]=t/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=o&&o!==1/0?(e[10]=(o+i)*(t=1/(i-o)),e[14]=2*o*i*t):(e[10]=-1,e[14]=-2*i),this}lookAt(e){return this.lookAtPosition=e,this.updateViewMatrix(),this}}Oe.UP_VECTOR=[0,1,0];class Re{constructor(e,t,n,i,o,r){this.left=-1,this.right=1,this.top=1,this.bottom=-1,this.near=.1,this.far=2e3,this.zoom=1,this.position=[0,0,0],this.lookAtPosition=[0,0,0],this.projectionMatrix=be(),this.viewMatrix=be(),this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=o,this.far=r,this.updateProjectionMatrix()}setPosition({x:e=this.position[0],y:t=this.position[1],z:n=this.position[2]}){return this.position=[e,t,n],this}updateViewMatrix(){return we(this.viewMatrix,this.position,this.lookAtPosition,Re.UP_VECTOR),this}updateProjectionMatrix(){var e,t,n,i,o,r,a,s,l,u;return e=this.projectionMatrix,t=this.left,n=this.right,i=this.bottom,o=this.top,r=this.near,a=this.far,s=1/(t-n),l=1/(i-o),u=1/(r-a),e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*s,e[13]=(o+i)*l,e[14]=(a+r)*u,e[15]=1,this}lookAt(e){return this.lookAtPosition=e,this.updateViewMatrix(),this}}function Ue(n,i,o,r,a,e,s,l,u,d=0,c=1,h=2,f=1,p=-1,_=0,m=0){var g=_,v=a/l,b=e/u;for(let t=0;t<=u;t++){var y=t*b-e/2;for(let e=0;e<=l;e++,_++){var w,x,E,A=e*v-a/2;n[3*_+d]=A*f,n[3*_+c]=y*p,n[3*_+h]=s/2,i[3*_+d]=0,i[3*_+c]=0,i[3*_+h]=0<=s?1:-1,o[2*_]=e/l,o[2*_+1]=1-t/u,t!==u&&e!==l&&(w=g+e+t*(l+1),x=g+e+(t+1)*(l+1),E=g+e+(t+1)*(l+1)+1,A=g+e+t*(l+1)+1,r[6*m]=w,r[6*m+1]=x,r[6*m+2]=A,r[6*m+3]=x,r[6*m+4]=E,r[6*m+5]=A,m++)}}}function Le(e={}){var{width:t=1,height:n=1,depth:i=1,widthSegments:o=1,heightSegments:r=1,depthSegments:a=1}=e,s=o,l=r,u=a,d=(s+1)*(l+1)*2+(s+1)*(u+1)*2+(l+1)*(u+1)*2,c=6*(s*l*2+s*u*2+l*u*2),e=new Float32Array(3*d),o=new Float32Array(3*d),r=new Float32Array(2*d),a=new(65536<d?Uint32Array:Uint16Array)(c),d=0,c=0;return Ue(e,o,r,a,i,n,t,u,l,2,1,0,-1,-1,0,0),Ue(e,o,r,a,i,n,-t,u,l,2,1,0,1,-1,d+=(u+1)*(l+1),c+=u*l),Ue(e,o,r,a,t,i,n,u,l,0,2,1,1,1,d+=(u+1)*(l+1),c+=u*l),Ue(e,o,r,a,t,i,-n,u,l,0,2,1,1,-1,d+=(s+1)*(u+1),c+=s*u),Ue(e,o,r,a,t,n,-i,s,l,0,1,2,-1,-1,d+=(s+1)*(u+1),c+=s*u),Ue(e,o,r,a,t,n,i,s,l,0,1,2,1,-1,d+=(s+1)*(l+1),c+=s*l),{vertices:e,normal:o,uv:r,indices:a}}function Ne(e={}){var{width:t=1,height:n=1,depth:i=1,widthSegments:o=1,heightSegments:r=1,depthSegments:a=1}=e,s=o,l=r,u=a;const d=[];var c=(u+1)*(l+1),e=u*l*6,o=new Float32Array(3*c),r=new Float32Array(3*c),a=new Float32Array(2*c),c=new(65536<c?Uint32Array:Uint16Array)(e);Ue(o,r,a,c,i,n,t,u,l,2,1,0,-1,-1,0,0),d.push({orientation:"right",vertices:o,normal:r,uv:a,indices:c});e=(u+1)*(l+1),o=u*l*6,r=new Float32Array(3*e),a=new Float32Array(3*e),c=new Float32Array(2*e),e=new(65536<e?Uint32Array:Uint16Array)(o);Ue(r,a,c,e,i,n,-t,u,l,2,1,0,1,-1,0,0),d.push({orientation:"left",vertices:r,normal:a,uv:c,indices:e});o=(u+1)*(l+1),r=u*l*6,a=new Float32Array(3*o),c=new Float32Array(3*o),e=new Float32Array(2*o),o=new(65536<o?Uint32Array:Uint16Array)(r);Ue(a,c,e,o,t,i,n,u,l,0,2,1,1,1,0,0),d.push({orientation:"top",vertices:a,normal:c,uv:e,indices:o});r=(u+1)*(l+1),a=u*l*6,c=new Float32Array(3*r),e=new Float32Array(3*r),o=new Float32Array(2*r),a=new(65536<r?Uint32Array:Uint16Array)(a);Ue(c,e,o,a,t,i,-n,u,l,0,2,1,1,-1,0,0),d.push({orientation:"bottom",vertices:c,normal:e,uv:o,indices:a});c=(s+1)*(u+1),e=s*u*6,o=new Float32Array(3*c),a=new Float32Array(3*c),u=new Float32Array(2*c),c=new(65536<c?Uint32Array:Uint16Array)(e);Ue(o,a,u,c,t,n,-i,s,l,0,1,2,-1,-1,0,0),d.push({orientation:"back",vertices:o,normal:a,uv:u,indices:c});e=(s+1)*(l+1),o=s*l*6,a=new Float32Array(3*e),u=new Float32Array(3*e),c=new Float32Array(2*e),o=new(65536<e?Uint32Array:Uint16Array)(o);return Ue(a,u,c,o,t,n,i,s,l,0,1,2,1,-1,0,0),d.push({orientation:"front",vertices:a,normal:u,uv:c,indices:o}),d}Re.UP_VECTOR=[0,1,0];class Ge{static xp(e,t){var n=e[0],i=e[1],e=e[2];return t[0]=n,t[1]=-e,t[2]=i,t}static xn(e,t){var n=e[0],i=e[1],e=e[2];return t[0]=n,t[1]=e,t[2]=-i,t}static yp(e,t){var n=e[0],i=e[1],e=e[2];return t[0]=-e,t[1]=i,t[2]=n,t}static yn(e,t){var n=e[0],i=e[1],e=e[2];return t[0]=e,t[1]=i,t[2]=-n,t}static zp(e,t){var n=e[0],i=e[1],e=e[2];return t[0]=i,t[1]=-n,t[2]=e,t}static zn(e,t){var n=e[0],i=e[1],e=e[2];return t[0]=-i,t[1]=n,t[2]=e,t}static xp_yn(e,t){var n=e[0],i=e[1],e=e[2];return t[0]=-i,t[1]=-e,t[2]=n,t}static xp_yp(e,t){var n=e[0],i=e[1],e=e[2];return t[0]=i,t[1]=-e,t[2]=-n,t}static xp_yp_yp(e,t){var n=e[0],i=e[1],e=e[2];return t[0]=-n,t[1]=-e,t[2]=-i,t}static xp_xp(e,t){var n=e[0],i=e[1],e=e[2];return t[0]=n,t[1]=-i,t[2]=-e,t}}_=({width:e=1,height:t=1,depth:n=1,radius:i=.5,div:o=4})=>{i=function(e=2,t=2,n=2,r=.5,a=4){const s=e/2,i=t/2,l=n/2,u=2*a,d=[],c=[],h=[],f=xe();let o,p,_,m,g,v,b,y;b=i;const w=[Ee(r-s,i-r,r-l),Ee(s-r,i-r,r-l),Ee(r-s,i-r,l-r),Ee(s-r,i-r,l-r)],x=(e,t)=>{var n,i,o=Fe(-l,l,e);for(_=0;_<=u;_++)i=_<=a?0:1,n=ke(_/a),g=_<=a?-1:1,v=s*g+r*n*-g,Ae(f,v,b,e),Te(f,f,w[i|t]),Ce(f,f),h.push(f[0],f[1],f[2]),Me(f,f,r),Se(f,f,w[i|t]),d.push(f[0],f[1],f[2]),c.push(Fe(-s,s,v),o),1==n&&(Ae(f,s-r,b,e),Te(f,f,w[1|t]),Ce(f,f),h.push(f[0],f[1],f[2]),Me(f,f,r),Se(f,f,w[1|t]),d.push(f[0],f[1],f[2]),c.push(Fe(-s,s,s-r),o))};for(p=0;p<=u;p++)o=p<=a?0:2,m=ke(p/a),g=p<=a?-1:1,y=l*g+r*m*-g,x(y,o),1==m&&x(l-r,2);return{verts:d,uv:c,norm:h,indices:function(e,t){let n=[],i=e+1,o,r,a,s,l,u;for(r=0;r<t;r++)for(o=0;o<e;o++)a=r*i+o,s=a+i,l=s+1,u=a+1,n.push(a,s,l,l,u,a);return n}(1+u,1+u)}}(e,t,n,i,o),o={verts:[],indices:[],uv:[],norm:[]};return Ve(o,i,(e,t)=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t)),Ve(o,i,Ge.xp),Ve(o,i,Ge.xp_yp),Ve(o,i,Ge.xp_yp_yp),Ve(o,i,Ge.xp_yn),Ve(o,i,Ge.xp_xp),{vertices:new Float32Array(o.verts),normal:new Float32Array(o.norm),uv:new Float32Array(o.uv),indices:new Uint16Array(o.indices)}};function Ve(t,n,i){var e=t.verts.length/3,o=n.verts.length;const r=xe(),a=xe();for(let e=0;e<o;e+=3)Ae(r,n.verts[e],n.verts[e+1],n.verts[e+2]),i(r,a),t.verts.push(a[0],a[1],a[2]),Ae(r,n.norm[e],n.norm[e+1],n.norm[e+2]),i(r,a),t.norm.push(a[0],a[1],a[2]);for(const r of n.uv)t.uv.push(r);for(const r of n.indices)t.indices.push(e+r)}N=({width:e=1,height:t=1,depth:n=1,radius:i=.5,div:o=4})=>{i=function(e=2,t=2,n=2,r=.5,a=4){const s=e/2,i=t/2,l=n/2,u=2*a,d=[],c=[],h=[],f=xe();let o,p,_,m,g,v,b,y;b=i;const w=[Ee(r-s,i-r,r-l),Ee(s-r,i-r,r-l),Ee(r-s,i-r,l-r),Ee(s-r,i-r,l-r)],x=(e,t)=>{var n,i,o=Fe(-l,l,e);for(_=0;_<=u;_++)i=_<=a?0:1,n=ke(_/a),g=_<=a?-1:1,v=s*g+r*n*-g,Ae(f,v,b,e),Te(f,f,w[i|t]),Ce(f,f),h.push(f[0],f[1],f[2]),Me(f,f,r),Se(f,f,w[i|t]),d.push(f[0],f[1],f[2]),c.push(Fe(-s,s,v),o),1==n&&(Ae(f,s-r,b,e),Te(f,f,w[1|t]),Ce(f,f),h.push(f[0],f[1],f[2]),Me(f,f,r),Se(f,f,w[1|t]),d.push(f[0],f[1],f[2]),c.push(Fe(-s,s,s-r),o))};for(p=0;p<=u;p++)o=p<=a?0:2,m=ke(p/a),g=p<=a?-1:1,y=l*g+r*m*-g,x(y,o),1==m&&x(l-r,2);return{verts:d,uv:c,norm:h,indices:function(e,t){let n=[],i=e+1,o,r,a,s,l,u;for(r=0;r<t;r++)for(o=0;o<e;o++)a=r*i+o,s=a+i,l=s+1,u=a+1,n.push(a,s,l,l,u,a);return n}(1+u,1+u)}}(e,t,n,i,o);const r=[];o={verts:[],indices:[],uv:[],norm:[]};return Ie(o,i,(e,t)=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t)),r.push({orientation:"top",vertices:new Float32Array(o.verts),normal:new Float32Array(o.norm),uv:new Float32Array(o.uv),indices:new Uint16Array(o.indices)}),Ie(o={verts:[],indices:[],uv:[],norm:[]},i,Ge.xp),r.push({orientation:"front",vertices:new Float32Array(o.verts),normal:new Float32Array(o.norm),uv:new Float32Array(o.uv),indices:new Uint16Array(o.indices)}),Ie(o={verts:[],indices:[],uv:[],norm:[]},i,Ge.xp_yp),r.push({orientation:"left",vertices:new Float32Array(o.verts),normal:new Float32Array(o.norm),uv:new Float32Array(o.uv),indices:new Uint16Array(o.indices)}),Ie(o={verts:[],indices:[],uv:[],norm:[]},i,Ge.xp_yp_yp),r.push({orientation:"back",vertices:new Float32Array(o.verts),normal:new Float32Array(o.norm),uv:new Float32Array(o.uv),indices:new Uint16Array(o.indices)}),Ie(o={verts:[],indices:[],uv:[],norm:[]},i,Ge.xp_yn),r.push({orientation:"right",vertices:new Float32Array(o.verts),normal:new Float32Array(o.norm),uv:new Float32Array(o.uv),indices:new Uint16Array(o.indices)}),Ie(o={verts:[],indices:[],uv:[],norm:[]},i,Ge.xp_xp),r.push({orientation:"bottom",vertices:new Float32Array(o.verts),normal:new Float32Array(o.norm),uv:new Float32Array(o.uv),indices:new Uint16Array(o.indices)}),r};function Ie(t,n,i){var e=t.verts.length/3,o=n.verts.length;const r=xe(),a=xe();for(let e=0;e<o;e+=3)Ae(r,n.verts[e],n.verts[e+1],n.verts[e+2]),i(r,a),t.verts.push(a[0],a[1],a[2]),Ae(r,n.norm[e],n.norm[e+1],n.norm[e+2]),i(r,a),t.norm.push(a[0],a[1],a[2]);for(const r of n.uv)t.uv.push(r);for(const r of n.indices)t.indices.push(e+r)}function De(e={}){var{radius:n=1,segments:i=8,thetaStart:o=0,thetaLength:r=2*Math.PI}=e;const t=[],a=[],s=[],l=[],u=xe(),d=Be();a.push(0,0,0),s.push(0,0,1),l.push(.5,.5);for(let e=0,t=3;e<=i;e++,t+=3){var c=o+e/i*r;u[0]=n*Math.cos(c),u[1]=n*Math.sin(c),a.push(...u),s.push(0,0,1),d[0]=(a[t]/n+1)/2,d[1]=(a[t+1]/n+1)/2,l.push(d[0],d[1])}for(let e=1;e<=i;e++)t.push(e,e+1,0);return{indices:new(65536<i?Uint32Array:Uint16Array)(t),vertices:new Float32Array(a),normal:new Float32Array(s),uv:new Float32Array(l)}}function ze(e={}){var{width:t=1,height:n=1,widthSegments:i=1,heightSegments:o=1}=e,r=i,a=o,s=(r+1)*(a+1),l=r*a*6,e=new Float32Array(3*s),i=new Float32Array(3*s),o=new Float32Array(2*s),l=new(65536<s?Uint32Array:Uint16Array)(l);return Ue(e,i,o,l,t,n,0,r,a),{vertices:e,normal:i,uv:o,indices:l}}function He(e={}){var{radius:t=.5,widthSegments:n=16,heightSegments:i=Math.ceil(.5*n),phiStart:o=0,phiLength:r=2*Math.PI,thetaStart:a=0,thetaLength:e=Math.PI}=e,s=n,l=i,u=o,d=r,c=a,h=e,a=(s+1)*(l+1),e=s*l*6;const f=new Float32Array(3*a),p=new Float32Array(3*a),_=new Float32Array(2*a),m=new(65536<a?Uint32Array:Uint16Array)(e);let g=0,v=0,b=0;var y=c+h;const w=[];var x=xe();for(let e=0;e<=l;e++){const k=[];var E=e/l;for(let e=0;e<=s;e++,g++){var A=e/s,S=-t*Math.cos(u+A*d)*Math.sin(c+E*h),M=t*Math.cos(c+E*h),C=t*Math.sin(u+A*d)*Math.sin(c+E*h);Ae(x,f[3*g]=S,f[3*g+1]=M,f[3*g+2]=C),Ce(x,x),p[3*g]=x[0],p[3*g+1]=x[1],p[3*g+2]=x[2],_[2*g]=A,_[2*g+1]=1-E,k.push(v++)}w.push(k)}for(let t=0;t<l;t++)for(let e=0;e<s;e++){var T=w[t][e+1],B=w[t][e],P=w[t+1][e],F=w[t+1][e+1];(0!==t||0<c)&&(m[3*b]=T,m[3*b+1]=B,m[3*b+2]=F,b++),(t!==l-1||y<Math.PI)&&(m[3*b]=B,m[3*b+1]=P,m[3*b+2]=F,b++)}return{vertices:f,normal:p,uv:_,indices:m}}function je(e={}){var{radius:n=.5,tube:i=.35,arc:o=2*Math.PI,radialSegments:t=8,tubularSegments:e=6}=e,r=Math.floor(t),a=Math.floor(e);const s=[],l=[],u=[],d=[],c=xe(),h=xe();var f=xe();for(let t=0;t<=r;t++)for(let e=0;e<=a;e++){var p=e/a*o,_=t/r*Math.PI*2;h[0]=(n+i*Math.cos(_))*Math.cos(p),h[1]=(n+i*Math.cos(_))*Math.sin(p),h[2]=i*Math.sin(_),l.push(h[0],h[1],h[2]),c[0]=n*Math.cos(p),c[1]=n*Math.sin(p),Te(f,h,c),Ce(f,f),u.push(f[0],f[1],f[0]),d.push(e/a,t/r)}for(let t=1;t<=r;t++)for(let e=1;e<=a;e++){var m=(a+1)*t+e-1,g=(a+1)*(t-1)+e-1,v=(a+1)*(t-1)+e,b=(a+1)*t+e;s.push(m,g,b),s.push(g,v,b)}return{indices:new(65536<(r+1)*(a+1)?Uint32Array:Uint16Array)(s),vertices:new Float32Array(l),normal:new Float32Array(u),uv:new Float32Array(d)}}var Ye=Object.freeze({__proto__:null,createBox:Le,createBoxSeparateFace:Ne,createRoundedBoxSeparateFace:N,createRoundedBox:_,createCircle:De,createPlane:ze,createSphere:He,createTorus:je,GeometryUtils:{createBox:Le,createBoxSeparateFace:Ne,createRoundedBoxSeparateFace:N,createRoundedBox:_,createCircle:De,createPlane:ze,createSphere:He,createTorus:je}}),Xe="undefined"!=typeof Float32Array?Float32Array:Array;function qe(){var e=new Xe(16);return Xe!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function We(){var e=new Xe(3);return Xe!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ke(e,t,n,i){return e[0]=t,e[1]=n,e[2]=i,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),We();const Je=We(),Qe=qe(),Ze=qe(),$e=(e,n)=>{const i=new Float32Array(16*e),o=new Float32Array(16*e);for(let t=0;t<16*e;t+=16){var{randX:r,randY:a,randZ:s,randRotX:l,randRotY:u,randRotZ:d,randScaleX:c,randScaleY:h,randScaleZ:f}=n(t);(R=Qe)[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,Ke(Je,r,a,s),g=Qe,v=Qe,b=Je,O=k=F=P=B=T=C=M=S=A=E=x=w=y=void 0,F=b[0],k=b[1],O=b[2],v===g?(g[12]=v[0]*F+v[4]*k+v[8]*O+v[12],g[13]=v[1]*F+v[5]*k+v[9]*O+v[13],g[14]=v[2]*F+v[6]*k+v[10]*O+v[14],g[15]=v[3]*F+v[7]*k+v[11]*O+v[15]):(y=v[0],w=v[1],x=v[2],E=v[3],A=v[4],S=v[5],M=v[6],C=v[7],T=v[8],B=v[9],P=v[10],b=v[11],g[0]=y,g[1]=w,g[2]=x,g[3]=E,g[4]=A,g[5]=S,g[6]=M,g[7]=C,g[8]=T,g[9]=B,g[10]=P,g[11]=b,g[12]=y*F+A*k+T*O+v[12],g[13]=w*F+S*k+B*O+v[13],g[14]=x*F+M*k+P*O+v[14],g[15]=E*F+C*k+b*O+v[15]),p=Qe,_=Qe,m=l,S=w=T=A=y=s=a=r=R=void 0,R=Math.sin(m),r=Math.cos(m),a=_[4],s=_[5],y=_[6],A=_[7],T=_[8],w=_[9],S=_[10],m=_[11],_!==p&&(p[0]=_[0],p[1]=_[1],p[2]=_[2],p[3]=_[3],p[12]=_[12],p[13]=_[13],p[14]=_[14],p[15]=_[15]),p[4]=a*r+T*R,p[5]=s*r+w*R,p[6]=y*r+S*R,p[7]=A*r+m*R,p[8]=T*r-a*R,p[9]=w*r-s*R,p[10]=S*r-y*R,p[11]=m*r-A*R,B=Qe,x=Qe,M=u,v=O=b=k=C=F=E=g=P=void 0,P=Math.sin(M),g=Math.cos(M),E=x[0],F=x[1],C=x[2],k=x[3],b=x[8],O=x[9],v=x[10],M=x[11],x!==B&&(B[4]=x[4],B[5]=x[5],B[6]=x[6],B[7]=x[7],B[12]=x[12],B[13]=x[13],B[14]=x[14],B[15]=x[15]),B[0]=E*g-b*P,B[1]=F*g-O*P,B[2]=C*g-v*P,B[3]=k*g-M*P,B[8]=E*P+b*g,B[9]=F*P+O*g,B[10]=C*P+v*g,B[11]=k*P+M*g,l=Qe,_=Qe,T=d,A=r=m=p=y=S=s=w=a=void 0,a=Math.sin(T),w=Math.cos(T),s=_[0],S=_[1],y=_[2],p=_[3],m=_[4],r=_[5],A=_[6],T=_[7],_!==l&&(l[8]=_[8],l[9]=_[9],l[10]=_[10],l[11]=_[11],l[12]=_[12],l[13]=_[13],l[14]=_[14],l[15]=_[15]),l[0]=s*w+m*a,l[1]=S*w+r*a,l[2]=y*w+A*a,l[3]=p*w+T*a,l[4]=m*w-s*a,l[5]=r*w-S*a,l[6]=A*w-y*a,l[7]=T*w-p*a,Ke(Je,c,h,f),R=Qe,u=Qe,x=Je,b=E=void 0,E=x[0],b=x[1],x=x[2],R[0]=u[0]*E,R[1]=u[1]*E,R[2]=u[2]*E,R[3]=u[3]*E,R[4]=u[4]*b,R[5]=u[5]*b,R[6]=u[6]*b,R[7]=u[7]*b,R[8]=u[8]*x,R[9]=u[9]*x,R[10]=u[10]*x,R[11]=u[11]*x,R[12]=u[12],R[13]=u[13],R[14]=u[14],R[15]=u[15],F=Ze,O=Qe,u=R=x=b=E=f=h=c=a=p=w=T=l=y=A=S=r=s=m=_=d=g=M=P=k=B=v=C=void 0,C=O[0],v=O[1],B=O[2],k=O[3],P=O[4],M=O[5],g=O[6],d=O[7],_=O[8],m=O[9],s=O[10],r=O[11],S=O[12],A=O[13],y=O[14],l=O[15],(O=(T=C*M-v*P)*(u=s*l-r*y)-(w=C*g-B*P)*(R=m*l-r*A)+(p=C*d-k*P)*(x=m*y-s*A)+(a=v*g-B*M)*(b=_*l-r*S)-(c=v*d-k*M)*(E=_*y-s*S)+(h=B*d-k*g)*(f=_*A-m*S))&&(F[0]=(M*u-g*R+d*x)*(O=1/O),F[1]=(B*R-v*u-k*x)*O,F[2]=(A*h-y*c+l*a)*O,F[3]=(s*c-m*h-r*a)*O,F[4]=(g*b-P*u-d*E)*O,F[5]=(C*u-B*b+k*E)*O,F[6]=(y*p-S*h-l*w)*O,F[7]=(_*h-s*p+r*w)*O,F[8]=(P*R-M*b+d*f)*O,F[9]=(v*b-C*R-k*f)*O,F[10]=(S*c-A*p+l*T)*O,F[11]=(m*p-_*c-r*T)*O,F[12]=(M*E-P*x-g*f)*O,F[13]=(C*x-v*E+B*f)*O,F[14]=(A*w-S*a-y*T)*O,F[15]=(_*a-m*w+s*T)*O),F=Ze,_=Ze,O=T=s=w=m=a=void 0,F===_?(a=_[1],m=_[2],w=_[3],s=_[6],T=_[7],O=_[11],F[1]=_[4],F[2]=_[8],F[3]=_[12],F[4]=a,F[6]=_[9],F[7]=_[13],F[8]=m,F[9]=s,F[11]=_[14],F[12]=w,F[13]=T,F[14]=O):(F[0]=_[0],F[1]=_[4],F[2]=_[8],F[3]=_[12],F[4]=_[1],F[5]=_[5],F[6]=_[9],F[7]=_[13],F[8]=_[2],F[9]=_[6],F[10]=_[10],F[11]=_[14],F[12]=_[3],F[13]=_[7],F[14]=_[11],F[15]=_[15]);for(let e=0;e<16;e++)i[t+e]=Qe[e],o[t+e]=Ze[e]}var p,_,m,g,v,b,y,w,x,E,A,S,M,C,T,B,P,F,k,O,R;return{instanceModelMatrixData:i,instanceNormalMatrixData:o}},et=(e,t)=>{var{vertices:n,uv:i,normal:o,indices:t}=t;const r=e.createBuffer({size:n.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Float32Array(r.getMappedRange()).set(n),r.unmap();const a=e.createBuffer({size:i.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Float32Array(a.getMappedRange()).set(i),a.unmap();const s=e.createBuffer({size:o.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Float32Array(s.getMappedRange()).set(o),s.unmap();const l=e.createBuffer({size:t.byteLength,usage:GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});return new(t instanceof Uint16Array?Uint16Array:Uint32Array)(l.getMappedRange()).set(t),l.unmap(),{verticesBuffer:r,normalsBuffer:s,uvsBuffer:a,indexBuffer:l,indices:t}};const tt=new v,nt={animatable:!0,tweenFactor:0};tt.add(nt,"animatable"),tt.add(nt,"tweenFactor").min(0).max(1).step(.01).listen();let it=0;function ot(e=!0){var t=20*(2*Math.random()-1),n=20*(2*Math.random()-1),i=20*(2*Math.random()-1),o=Math.random()*Math.PI*2,r=Math.random()*Math.PI*2,a=Math.random()*Math.PI*2,s=Math.random()+.25;return{randX:t,randY:n,randZ:i,randRotX:o,randRotY:r,randRotZ:a,randScaleX:s,randScaleY:e?s:Math.random()+.25,randScaleZ:e?s:Math.random()+.25}}e(void 0,void 0,void 0,function*(){var e=yield null===(e=navigator.gpu)||void 0===e?void 0:e.requestAdapter();const t=`
    <div id="no-webgpu-wrapper">
      <div id="no-webgpu">
        WebGPU is not supported on this browser. Please try modern Google Chrome (Canary) or Firefox Nightly.
      </div>
    </div>
  `;window.addEventListener("unhandledrejection",e=>{document.body.innerHTML+=t}),window.addEventListener("error",e=>{document.body.innerHTML+=t}),e||(document.body.innerHTML+=t)}),e(void 0,void 0,void 0,function*(){const e=document.getElementById("gpu-c");e.width=innerWidth*devicePixelRatio,e.height=innerHeight*devicePixelRatio,e.style.setProperty("width",`${innerWidth}px`),e.style.setProperty("height",`${innerHeight}px`);const t=yield null===(r=navigator.gpu)||void 0===r?void 0:r.requestAdapter(),l=yield null===t||void 0===t?void 0:t.requestDevice(),u=e.getContext("webgpu");var n=u.getPreferredFormat(t);const d=[e.width,e.height];var i="triangle-list";u.configure({device:l,format:n,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,size:d});const c=new Oe(45*Math.PI/180,e.width/e.height,.1,100),h=new Re(-e.width/2,e.width/2,e.height/2,-e.height/2,.1,3);h.setPosition({x:0,y:0,z:2}),h.lookAt([0,0,0]),h.updateProjectionMatrix(),h.updateViewMatrix();const{verticesBuffer:f,uvsBuffer:p,indexBuffer:_,indices:m}=et(l,Ye.createPlane({width:innerWidth,height:innerHeight})),{verticesBuffer:g,normalsBuffer:v,indexBuffer:b,indices:y}=et(l,Ye.createBox());var{instanceModelMatrixData:o,instanceNormalMatrixData:r}=$e(500,ot.bind(null,!1));const w=l.createBuffer({size:o.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Float32Array(w.getMappedRange()).set(o),w.unmap();const x=l.createBuffer({size:r.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Float32Array(x.getMappedRange()).set(r),x.unmap();const{verticesBuffer:E,normalsBuffer:A,indexBuffer:S,indices:M}=et(l,Ye.createSphere());var{instanceModelMatrixData:o,instanceNormalMatrixData:r}=$e(500,ot);const C=l.createBuffer({size:o.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Float32Array(C.getMappedRange()).set(o),C.unmap();const T=l.createBuffer({size:r.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Float32Array(T.getMappedRange()).set(r),T.unmap();const B=l.createRenderPipeline({vertex:{module:l.createShaderModule({code:"\n[[block]]\nstruct Camera {\n  projectionMatrix: mat4x4<f32>;\n  viewMatrix: mat4x4<f32>;\n};\n\n[[group(0), binding(0)]]\nvar<uniform> camera: Camera;\n\n[[block]]\nstruct Transform {\n  modelMatrix: mat4x4<f32>;\n};\n\n[[group(1), binding(0)]]\nvar<uniform> transform: Transform;\n\nstruct Input {\n  [[location(0)]] position: vec4<f32>;\n  [[location(1)]] uv: vec2<f32>;\n};\n\nstruct Output {\n  [[builtin(position)]] Position: vec4<f32>;\n  [[location(0)]] uv: vec2<f32>;\n};\n\n[[stage(vertex)]]\nfn main (input: Input) -> Output {\n  var output: Output;\n\n  output.Position = camera.projectionMatrix *\n                    camera.viewMatrix *\n                    transform.modelMatrix *\n                    input.position;\n                    \n  output.uv = input.uv;\n\n  return output;\n}\n"}),entryPoint:"main",buffers:[{arrayStride:3*Float32Array.BYTES_PER_ELEMENT,attributes:[{shaderLocation:0,format:"float32x3",offset:0}]},{arrayStride:2*Float32Array.BYTES_PER_ELEMENT,attributes:[{shaderLocation:1,format:"float32x2",offset:0}]}]},fragment:{module:l.createShaderModule({code:"\nstruct Input {\n  [[location(0)]] uv: vec2<f32>;\n};\n\n[[group(2), binding(0)]] var mySampler: sampler;\n[[group(2), binding(1)]] var postFX0Texture: texture_2d<f32>;\n[[group(2), binding(2)]] var postFX1Texture: texture_2d<f32>;\n[[group(2), binding(3)]] var cutOffTexture: texture_2d<f32>;\n\n[[block]]\nstruct Tween {\n  factor: f32;\n};\n\n[[group(3), binding(0)]]\nvar <uniform> tween: Tween;\n\n[[stage(fragment)]]\n\nfn main (input: Input) -> [[location(0)]] vec4<f32> {\n  let result0: vec4<f32> = textureSample(postFX0Texture, mySampler, input.uv);\n  let result1: vec4<f32> = textureSample(postFX1Texture, mySampler, input.uv);\n\n  let cutoffResult: vec4<f32> = textureSample(cutOffTexture, mySampler, input.uv);\n\n  let mixFactor: f32 = step(tween.factor * 1.05, cutoffResult.r);\n\n  return mix(result0, result1, mixFactor);\n}\n"}),entryPoint:"main",targets:[{format:n}]},primitive:{topology:i,stripIndexFormat:void 0}}),P=l.createRenderPipeline({vertex:{module:l.createShaderModule({code:"\n[[block]]\nstruct Camera {\n  projectionMatrix: mat4x4<f32>;\n  viewMatrix: mat4x4<f32>;\n};\n\n[[group(0), binding(0)]]\nvar<uniform> camera: Camera;\n\nstruct Input {\n  [[location(0)]] position: vec4<f32>;\n  [[location(1)]] normal: vec3<f32>;\n\n  [[location(2)]] instanceModelMatrix0: vec4<f32>;\n  [[location(3)]] instanceModelMatrix1: vec4<f32>;\n  [[location(4)]] instanceModelMatrix2: vec4<f32>;\n  [[location(5)]] instanceModelMatrix3: vec4<f32>;\n\n  [[location(6)]] instanceNormalMatrix0: vec4<f32>;\n  [[location(7)]] instanceNormalMatrix1: vec4<f32>;\n  [[location(8)]] instanceNormalMatrix2: vec4<f32>;\n  [[location(9)]] instanceNormalMatrix3: vec4<f32>;\n};\n\nstruct Output {\n  [[builtin(position)]] Position: vec4<f32>;\n  [[location(0)]] normal: vec4<f32>;\n  [[location(1)]] pos: vec4<f32>;\n};\n\n[[stage(vertex)]]\nfn main (input: Input) -> Output {\n  var output: Output;\n\n  let instanceModelMatrix: mat4x4<f32> = mat4x4<f32>(\n    input.instanceModelMatrix0,\n    input.instanceModelMatrix1,\n    input.instanceModelMatrix2,\n    input.instanceModelMatrix3\n  );\n\n  let instanceModelInverseTransposeMatrix: mat4x4<f32> = mat4x4<f32>(\n    input.instanceNormalMatrix0,\n    input.instanceNormalMatrix1,\n    input.instanceNormalMatrix2,\n    input.instanceNormalMatrix3\n  );\n\n  let worldPosition: vec4<f32> = instanceModelMatrix * input.position;\n\n  output.Position = camera.projectionMatrix *\n                    camera.viewMatrix *\n                    worldPosition;\n                    \n  output.normal = instanceModelInverseTransposeMatrix * vec4<f32>(input.normal, 0.0);\n  output.pos = worldPosition;\n\n  return output;\n}\n"}),entryPoint:"main",buffers:[{arrayStride:3*Float32Array.BYTES_PER_ELEMENT,attributes:[{shaderLocation:0,format:"float32x3",offset:0}]},{arrayStride:3*Float32Array.BYTES_PER_ELEMENT,attributes:[{shaderLocation:1,format:"float32x3",offset:0}]},{arrayStride:16*Float32Array.BYTES_PER_ELEMENT,stepMode:"instance",attributes:[{shaderLocation:2,format:"float32x4",offset:0},{shaderLocation:3,format:"float32x4",offset:4*Float32Array.BYTES_PER_ELEMENT},{shaderLocation:4,format:"float32x4",offset:8*Float32Array.BYTES_PER_ELEMENT},{shaderLocation:5,format:"float32x4",offset:12*Float32Array.BYTES_PER_ELEMENT}]},{arrayStride:16*Float32Array.BYTES_PER_ELEMENT,stepMode:"instance",attributes:[{shaderLocation:6,format:"float32x4",offset:0},{shaderLocation:7,format:"float32x4",offset:4*Float32Array.BYTES_PER_ELEMENT},{shaderLocation:8,format:"float32x4",offset:8*Float32Array.BYTES_PER_ELEMENT},{shaderLocation:9,format:"float32x4",offset:12*Float32Array.BYTES_PER_ELEMENT}]}]},fragment:{module:l.createShaderModule({code:"\n[[block]]\nstruct Lighting {\n  position: vec3<f32>;\n};\n\n[[group(1), binding(0)]]\nvar <uniform> lighting: Lighting;\n\n[[block]]\nstruct Material {\n  baseColor: vec3<f32>;\n};\n\n[[group(2), binding(0)]]\nvar <uniform> material: Material;\n\nstruct Input {\n  [[location(0)]] normal: vec4<f32>;\n  [[location(1)]] pos: vec4<f32>;\n};\n\n[[stage(fragment)]]\n\nfn main (input: Input) -> [[location(0)]] vec4<f32> {\n  let normal: vec3<f32> = normalize(input.normal.rgb);\n  let lightColor: vec3<f32> = vec3<f32>(1.0);\n\n  // ambient light\n  let ambientFactor: f32 = 0.1;\n  let ambientLight: vec3<f32> = lightColor * ambientFactor;\n\n  // diffuse light\n  let lightDirection: vec3<f32> = normalize(lighting.position - input.pos.rgb);\n  let diffuseStrength: f32 = max(dot(normal, lightDirection), 0.0);\n  let diffuseLight: vec3<f32> = lightColor * diffuseStrength;\n\n  // combine lighting\n  let finalLight: vec3<f32> = diffuseLight + ambientLight;\n\n  return vec4<f32>(material.baseColor * finalLight, 1.0);\n}\n"}),entryPoint:"main",targets:[{format:n}]},primitive:{topology:i,stripIndexFormat:void 0},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}}),F=l.createBuffer({size:32*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),k=l.createBindGroup({layout:P.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:F,offset:0,size:32*Float32Array.BYTES_PER_ELEMENT}}]}),O=l.createBuffer({size:32*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),R=l.createBindGroup({layout:B.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:O,offset:0,size:32*Float32Array.BYTES_PER_ELEMENT}}]}),U=new Pe,L=l.createBuffer({size:16*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),N=l.createBindGroup({layout:B.getBindGroupLayout(1),entries:[{binding:0,resource:{buffer:L,offset:0,size:16*Float32Array.BYTES_PER_ELEMENT}}]}),G=l.createTexture({size:d,format:n,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST}),V=l.createTexture({size:d,format:n,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST});r=l.createSampler({magFilter:"linear",minFilter:"linear"});const a=new Image;a.src=`${window.ASSETS_BASE_URL}/transition2.png`,yield a.decode();i=yield createImageBitmap(a);const s=l.createTexture({size:[i.width,i.height,1],format:n,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});l.queue.copyExternalImageToTexture({source:i},{texture:s},[i.width,i.height]);const I=l.createBindGroup({layout:B.getBindGroupLayout(2),entries:[{binding:0,resource:r},{binding:1,resource:G.createView()},{binding:2,resource:V.createView()},{binding:3,resource:s.createView()}]}),D=l.createBuffer({size:Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),z=new Float32Array([nt.tweenFactor]);let H=nt.tweenFactor;const j=l.createBindGroup({layout:B.getBindGroupLayout(3),entries:[{binding:0,resource:{buffer:D}}]});n=new Float32Array([.5,.5,.5]),i=l.createBuffer({size:4*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});const Y=l.createBindGroup({layout:P.getBindGroupLayout(1),entries:[{binding:0,resource:{buffer:i,offset:0,size:4*Float32Array.BYTES_PER_ELEMENT}}]});r=l.createBuffer({size:4*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});const X=l.createBindGroup({layout:P.getBindGroupLayout(2),entries:[{binding:0,resource:{buffer:r,offset:0,size:4*Float32Array.BYTES_PER_ELEMENT}}]});l.queue.writeBuffer(r,0,new Float32Array([.3,.6,.7]));r=l.createBuffer({size:4*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});const q=l.createBindGroup({layout:P.getBindGroupLayout(2),entries:[{binding:0,resource:{buffer:r,offset:0,size:4*Float32Array.BYTES_PER_ELEMENT}}]});l.queue.writeBuffer(r,0,new Float32Array([1,.2,.25])),l.queue.writeBuffer(i,0,n);const W=l.createTexture({size:[e.width,e.height,1],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT}),K={colorAttachments:[{view:null,loadValue:null,storeOp:"store"}],depthStencilAttachment:{view:W.createView(),depthLoadValue:1,depthStoreOp:"store",stencilLoadValue:0,stencilStoreOp:"store"}};setTimeout(()=>{H=1===H?0:1},100),setInterval(()=>{nt.animatable&&(H=1===H?0:1)},4e3),requestAnimationFrame(function e(t){requestAnimationFrame(e);t/=1e3;const n=t-it;it=t;const i=u.getCurrentTexture();const o=l.createCommandEncoder();K.colorAttachments[0].view=i.createView();K.colorAttachments[0].loadValue=[.1,.1,.1,1];const r=o.beginRenderPass(K);c.setPosition({x:20*Math.cos(.2*t),y:0,z:20*Math.sin(.2*t)});c.lookAt([0,0,0]);c.updateProjectionMatrix();c.updateViewMatrix();l.queue.writeBuffer(F,0,c.projectionMatrix);l.queue.writeBuffer(F,16*Float32Array.BYTES_PER_ELEMENT,c.viewMatrix);l.queue.writeBuffer(O,0,h.projectionMatrix);l.queue.writeBuffer(O,16*Float32Array.BYTES_PER_ELEMENT,h.viewMatrix);U.setRotation({x:Math.PI}).updateModelMatrix();l.queue.writeBuffer(L,0,U.modelMatrix);r.setPipeline(P);r.setBindGroup(0,k);r.setBindGroup(1,Y);r.setBindGroup(2,X);r.setVertexBuffer(0,g);r.setVertexBuffer(1,v);r.setVertexBuffer(2,w);r.setVertexBuffer(3,x);r.setIndexBuffer(b,y instanceof Uint16Array?"uint16":"uint32");r.drawIndexed(y.length,500);r.endPass();o.copyTextureToTexture({texture:i},{texture:G},d);K.colorAttachments[0].loadValue=[.225,.225,.225,1];const a=o.beginRenderPass(K);a.setPipeline(P);a.setBindGroup(0,k);a.setBindGroup(1,Y);a.setBindGroup(2,q);a.setVertexBuffer(0,E);a.setVertexBuffer(1,A);a.setVertexBuffer(2,C);a.setVertexBuffer(3,T);a.setIndexBuffer(S,M instanceof Uint16Array?"uint16":"uint32");a.drawIndexed(M.length,500);a.endPass();o.copyTextureToTexture({texture:i},{texture:V},d);const s=o.beginRenderPass({colorAttachments:[{view:i.createView(),loadValue:[.1,.1,.1,1],storeOp:"store"}]});nt.animatable&&(nt.tweenFactor+=(H-z[0])*(2*n));z[0]=nt.tweenFactor;l.queue.writeBuffer(D,0,z);s.setPipeline(B);s.setBindGroup(0,R);s.setBindGroup(1,N);s.setBindGroup(2,I);s.setBindGroup(3,j);s.setVertexBuffer(0,f);s.setVertexBuffer(1,p);s.setIndexBuffer(_,m instanceof Uint16Array?"uint16":"uint32");s.drawIndexed(m.length);s.endPass();l.queue.submit([o.finish()])})})}();
